{"version":3,"file":"TaskQueue.js","sourceRoot":"","sources":["../../src/struct/TaskQueue.ts"],"names":[],"mappings":";;;AAAA,MAAM,IAAI;IAIR,YAAY,WAAoB;QAC9B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,CAAO,GAAG,CAAC,EAAE;YACrC,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;QACrB,CAAC,CAAC,CAAC;IACL,CAAC;CACF;AAED;;;GAGG;AACH,MAAa,SAAS;IAAtB;QACE;;;;WAIG;QACK,UAAK,GAAW,EAAE,CAAC;IAmC7B,CAAC;IAjCC;;;;OAIG;IACI,OAAO,CAAC,WAAW,GAAG,KAAK;QAChC,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;QAC5F,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC;IACd,CAAC;IAED;;OAEG;IACI,OAAO;;QACZ,MAAA,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,0CAAE,OAAO,EAAE,CAAC;IAChC,CAAC;IAED;;;OAGG;IACH,IAAW,SAAS;QAClB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;IAC3B,CAAC;IAED;;;OAGG;IACH,IAAW,cAAc;QACvB,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;IAC/C,CAAC;CACF;AAzCD,8BAyCC","sourcesContent":["class Task {\n  resolve!: () => void;\n  promise: Promise<void>;\n  resolveInfo: boolean;\n  constructor(resolveInfo: boolean) {\n    this.resolveInfo = resolveInfo;\n    this.promise = new Promise<void>(res => {\n      this.resolve = res;\n    });\n  }\n}\n\n/**\n * Task queuing system\n * @private\n */\nexport class TaskQueue {\n  /**\n   * The task array\n   * @type {Task[]}\n   * @private\n   */\n  private tasks: Task[] = [];\n\n  /**\n   * Waits for last task finished and queues a new task\n   * @param {boolean} [resolveInfo=false] Whether the task is a resolving info task\n   * @returns {Promise<void>}\n   */\n  public queuing(resolveInfo = false): Promise<void> {\n    const next = this.remaining ? this.tasks[this.tasks.length - 1].promise : Promise.resolve();\n    this.tasks.push(new Task(resolveInfo));\n    return next;\n  }\n\n  /**\n   * Removes the finished task and processes the next task\n   */\n  public resolve(): void {\n    this.tasks.shift()?.resolve();\n  }\n\n  /**\n   * The remaining number of tasks\n   * @type {number}\n   */\n  public get remaining(): number {\n    return this.tasks.length;\n  }\n\n  /**\n   * Whether or not having a resolving info task\n   * @type {boolean}\n   */\n  public get hasResolveTask(): boolean {\n    return !!this.tasks.find(t => t.resolveInfo);\n  }\n}\n"]}